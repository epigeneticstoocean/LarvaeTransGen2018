---
title: "StatisticalLarvae"
output: html_document
---

setwd("~/Desktop/Repos/LarvaeTransGen2018/src")

Load packages
```{r echo=FALSE, include = FALSE, warning=FALSE}
# Code Dependencies
library(readr)
library(tidyr)
library(ggplot2)
library(Hmisc)
library(plyr)
library(bbmle)
library(blme)
library(MASS)
library(plyr)
library(reshape2)
library(lme4)
library(grid)
library(data.table)
library(gridExtra)
library(lattice)
library(optimx)
library(dplyr)
library(tidyverse)

larvae <- read.csv("../data/Larvae_morphology.csv")
```
Tests on mass per larvae
```{r}
# Male should be Random effect but wont converge so leaving off for now

area1 = lmer(sqrt(SurfaceAreaum2) ~ JarTrt * ParentTrt + (1|CrossID:JarID) +  (1|FemaleID) , data = larvae)

# Check model assumptions 
qqnorm(resid(area1))
qqline(resid(area1))

area2 = lmer(sqrt(SurfaceAreaum2) ~ JarTrt + ParentTrt +  (1|CrossID:JarID) +  (1|FemaleID) , data = larvae)
anova(area1,area2) # Significant interaction so we go with more complicated model





area3 = lmer(sqrt(SurfaceAreaum2) ~ 1 * ParentTrt +(1|CrossID:JarID) +  (1|FemaleID) , data = larvae)
anova(area1,area3) #Significant jar effect (larval treatment)

area4 = lmer(sqrt(SurfaceAreaum2) ~ JarTrt * 1 + (1|CrossID:JarID) +  (1|FemaleID) , data = larvae)
anova(area1, area4) # No significant adult effect

```
Tests on mass per larvae
```{r}
#Pull out single measurement per jar
larvae_simple <- larvae[!duplicated(larvae$JarID), ]

# Needs more data to be able to include random effect
mass1 = lm(log(F1WtPerLarvae) ~ JarTrt * ParentTrt, data = larvae_simple)

# Check out model assumptions
qqnorm(resid(mass1))
qqline(resid(mass1))

mass2 = lm(log(F1WtPerLarvae) ~ JarTrt + ParentTrt, data = larvae_simple)
anova(mass1,mass2) # No Significant interaction so we go with more simple model

mass3 = lm(log(F1WtPerLarvae) ~ 1 + ParentTrt, data = larvae_simple)
anova(mass2,mass3) #No larval treatment effect

mass4 = lm(log(F1WtPerLarvae) ~ JarTrt + 1, data = larvae_simple)
anova(mass2, mass4) # No significant adult effect

```

```{r}

```