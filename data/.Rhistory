title.col="black",
seg.len =1,
cex=.7,
yjust=0.5,
text.font = NULL,
inset = c(0,-.1)
)
plot(p1,overlay=TRUE, legend=FALSE, ylab=expression(paste("Growth (", mu, "m/day)")),xlab=expression(paste("Larvae Treatment ", Omega[Aragonite])), line=list(col=c("#004D4F", "#F7645A"), lwd=c(2,2)),
fill=list(col=c("#3BFAFF", "#FCCECB")),
points=list(col=c("#007367","#F98880"), pch=19, cex=0.4) )
legend.enhanced("topright",
c("Control", "OA-exposed"),
pch=19,
col=c("#007367","#F98880"),
bty="n",
title="Parent Treatment",
horiz=TRUE,
y.intersp=.7,
x.intersp=0.5,
title.adj=c(.5,0),
title.col="black",
seg.len =1,
cex=.7,
yjust=0.5,
text.font = NULL,
inset = c(0,-.15)
)
hist(ExpLarExpParByJar$EggDiamum)
hist(ExpLarExpParByJar$MeanGPD)
hist(ExpLarConParByJar$EggDiamum)
hist(ExpLarConParByJar$MeanGPD)
hist(log(ExpLarExpParByJar$EggDiamum))
hist(log(ExpLarConParByJar$EggDiamum))
shapiro.test(ExpLarConParByJar$EggDiamum)
qqline(ExpLarConParByJar$EggDiamum)
qqnorm(ExpLarConParByJar$EggDiamum)
qqline(ExpLarConParByJar$EggDiamum)
par(mfcol=c(1,1), xpd=FALSE)
qqnorm(ExpLarConParByJar$EggDiamum)
qqline(ExpLarConParByJar$EggDiamum)
qqnorm(ExpLarExpParByJar$EggDiamum)
qqline(ExpLarExpParByJar$EggDiamum)
qqnorm(ConFams$MeanGPDExp)
qqline(ConFams$MeanGPDExp)
qqnorm(ConFams$RatSurv)
qqline(ConFams$RatSurv)
qqnorm(ExpFams$MeanGPDExp)
qqline(ExpFams$MeanGPDExp)
qqnorm(ExpFams$RatSurv)
qqline(ExpFams$RatSurv)
par(mar=c(5,6,1,1), mfrow=c(1,1))
plot(RatSurv~MeanGPDExp, data=ConFams, pch=19, col="deepskyblue", xlim=c(-2, 2.4), ylim=c(0.6, 1.4), xlab= expression(paste("Mean Family Growth (", mu, "m/day)")), ylab="Proportion of Surviving Larvae \n (OA:Control)")
arrows(x0=(SurvWideDat$MeanGPDExp-SurvWideDat$SEMeanGPDCExp), x1= (SurvWideDat$MeanGPDExp+SurvWideDat$SEMeanGPDCExp), y0 = SurvWideDat$RatSurv, y1= SurvWideDat$RatSurv, code=3, angle=90, len=.1)
points(RatSurv~MeanGPDExp, data=ConFams, pch=19, col="gray70")
points(RatSurv~MeanGPDExp, data=ExpFams, pch=19, col="gray11")
plot(RatSurv~MeanGPDExp, data=ConFams, pch=19, col="#007367", xlim=c(-2, 2.4), ylim=c(0.6, 1.4), xlab= expression(paste("Mean Family Growth (", mu, "m/day)")), ylab="Proportion of Surviving Larvae \n (OA:Control)")
arrows(x0=(SurvWideDat$MeanGPDExp-SurvWideDat$SEMeanGPDCExp), x1= (SurvWideDat$MeanGPDExp+SurvWideDat$SEMeanGPDCExp), y0 = SurvWideDat$RatSurv, y1= SurvWideDat$RatSurv, code=3, angle=90, len=.1)
points(RatSurv~MeanGPDExp, data=ConFams, pch=19, col="#007367")
points(RatSurv~MeanGPDExp, data=ExpFams, pch=19, col="#F98880")
legend.enhanced("topright",
c("Control", "OA-exposed"),
pch=19,
col=c("#007367","#F98880"),
bty="n",
title="Parent Treatment",
horiz=TRUE,
y.intersp=.7,
x.intersp=0.5,
title.adj=c(.5,0),
title.col="black",
seg.len =1,
cex=.7,
yjust=0.5,
text.font = NULL,
inset = c(0,-.15)
)
par(xpd=TRUE)
legend.enhanced("topright",
c("Control", "OA-exposed"),
pch=19,
col=c("#007367","#F98880"),
bty="n",
title="Parent Treatment",
horiz=TRUE,
y.intersp=.7,
x.intersp=0.5,
title.adj=c(.5,0),
title.col="black",
seg.len =1,
cex=.7,
yjust=0.5,
text.font = NULL,
inset = c(0,-.15)
)
ggplot(SurvDat,aes(x=JarTrt, y=LarvaeSurvived, color = "black45", group= CrossID)) +
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("white", "gray85"))+
geom_point(aes(color="black45"))+
geom_line(aes(color="black45", group=CrossID))+
scale_x_discrete(labels=LarvTreat)+
geom_errorbar(aes(ymin= LarvaeSurvived-SELarvaeSurvived, ymax=LarvaeSurvived+SELarvaeSurvived),width=0.05, position=position_dodge(0))+
labs(x = "Larvae Treatment", y = "Number of Larvae Survived") +
scale_color_manual(values="black")+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat))+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
theme_classic()
geom_text(aes(label=c("a", "a"),
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = position_dodge(width=0.9),
size=4))+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=4))+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes((RatSurv+SESurvDat$RatSurv),  label=c("a", "a"),
position = 3,
size=4))+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(RatSurv+SESurvDat$RatSurv,  label=c("a", "a"),
position = 3,
size=4))+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=4))+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=4), vjust = -0.5)+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=4), vjust = -0.7)+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=2), vjust = -0.7)+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=2), vjust = -0.8)+
theme_classic()
warnings()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control Larval Treatment)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=2), vjust = -1)+
theme_classic()
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=2), vjust = -1)+
theme_classic()
ggplot(SurvDat,aes(x=JarTrt, y=LarvaeSurvived, color = "black45", group= CrossID)) +
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#3BFAFF", "#FCCECB"))+
geom_point(aes(color="black45"))+
geom_line(aes(color="black45", group=CrossID))+
scale_x_discrete(labels=LarvTreat)+
geom_errorbar(aes(ymin= LarvaeSurvived-SELarvaeSurvived, ymax=LarvaeSurvived+SELarvaeSurvived),width=0.05, position=position_dodge(0))+
labs(x = "Larvae Treatment", y = "Number of Larvae Survived") +
scale_color_manual(values="black")+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat))+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
ggplot(SurvDat,aes(x=JarTrt, y=LarvaeSurvived, color = "black45", group= CrossID)) +
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_point(aes(color="black45"))+
geom_line(aes(color="black45", group=CrossID))+
scale_x_discrete(labels=LarvTreat)+
geom_errorbar(aes(ymin= LarvaeSurvived-SELarvaeSurvived, ymax=LarvaeSurvived+SELarvaeSurvived),width=0.05, position=position_dodge(0))+
labs(x = "Larvae Treatment", y = "Number of Larvae Survived") +
scale_color_manual(values="black")+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat))+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
#pull means for the control larvae control parents
ConConMeans<- meanJarTrt %>%
filter(JarTrt=="Control" & ParentTrt=="400") %>%
subset(select= c("MeanGPD", "LarvaePerimeterum", "LarvaeAreaum2",  "LarvaeDiamum"))
ConExpMeans<- meanJarTrt %>%
filter(JarTrt=="Exposed" & ParentTrt=="400") %>%
subset(select= c("MeanGPD", "LarvaePerimeterum", "LarvaeAreaum2",  "LarvaeDiamum"))
#EF01_EM01 only has one cross, so a boxplot won't work. Remove from the data before trying to make the plots:
LarvByJarVarVizDat<- subset(LarvByJarDat, CrossID !="EF01_EM01_B1_QG")
LarvByJarVarVizDat$ParentTrt<- factor(LarvByJarVarVizDat$ParentTrt, levels= c("400", "2600"))
ggplot(LarvByJarVarVizDat, aes(y=MeanGPD,x=as.factor(MaleIDNumber), color=JarTrt))+
geom_boxplot(alpha=0.5, position="identity") +
facet_grid(~ParentTrt*FemaleIDNumber, scale="free_x")+
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_boxplot(alpha=0.5, position="identity") +
labs(x = "Male ID", y= expression(paste("Growth (", mu, "m/day)")), title = "Female ID") +
scale_color_manual(name = "Larval Treatment", labels = c("Control", "OA"), values = c("#004D4F", "#F7645A"))+
geom_hline(yintercept=0)+
geom_hline(yintercept=ConConMeans$MeanGPD, color="navyblue", lty=2)+
geom_hline(yintercept=0, ConExpMeans$MeanGPD, color="red", lty=2)+
theme_classic() +
theme(axis.title.y.right = element_blank(),                # hide right axis title
axis.text.y.right = element_blank(),                 # hide right axis labels
axis.ticks.y = element_blank(),                      # hide left/right axis ticks
axis.text.y = element_text(margin = margin(r = 0)),  # move left axis labels closer to axis
panel.spacing = unit(0, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), axis.text.x=element_text(angle=90),plot.title = element_text(size=10, hjust = 0.5), panel.border= element_blank())
ggplot(LarvByJarVarVizDat, aes(y=LarvaeAreaum2,x=as.factor(MaleIDNumber), color=JarTrt))+
geom_boxplot(alpha=0.5, position="identity") +
facet_grid(~ParentTrt*FemaleIDNumber, scale="free_x")+
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_boxplot(alpha=0.5, position="identity") +
labs(x = "Male ID", y= expression(paste("Surface Area (", mu, m^2,")")), title = "Female ID") +
scale_color_manual(name = "Larval Treatment", labels = c("Control", "OA"), values = c("#004D4F", "#F7645A"))+
geom_hline(aes(yintercept=ConConMeans$LarvaeAreaum2), color= "navyblue", lty=2)+
geom_hline(aes(yintercept=ConExpMeans$LarvaeAreaum2), color= "red", lty=2)+
theme_classic() +
theme(axis.title.y.right = element_blank(),                # hide right axis title
axis.text.y.right = element_blank(),                 # hide right axis labels
axis.ticks.y = element_blank(),                      # hide left/right axis ticks
axis.text.y = element_text(margin = margin(r = 0)),  # move left axis labels closer to axis
panel.spacing = unit(0, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), axis.text.x=element_text(angle=90),plot.title = element_text(size=10, hjust = 0.5), panel.border= element_blank())
ggplot(LarvByJarVarVizDat, aes(y=LarvaeDiamum ,x=MaleIDNumber, color=JarTrt))+
geom_boxplot(alpha=0.5, position="identity") +
facet_grid(~ParentTrt*FemaleIDNumber, scale="free_x")+
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_boxplot(alpha=0.5, position="identity") +
labs(x = "Male ID", y= expression(paste("Length (", mu, "m)")), title = "Female ID") +
scale_color_manual(name = "Larval Treatment", labels = c("Control", "OA"), values = c("#004D4F", "#F7645A"))+
geom_hline(yintercept=ConConMeans$LarvaeDiamum, color="midnightblue", lty=2)+
geom_hline(yintercept=ConExpMeans$LarvaeDiamum, color="red", lty=2)+
theme_classic() +
theme(axis.title.y.right = element_blank(),                # hide right axis title
axis.text.y.right = element_blank(),                 # hide right axis labels
axis.ticks.y = element_blank(),                      # hide left/right axis ticks
axis.text.y = element_text(margin = margin(r = 0)),  # move left axis labels closer to axis
panel.spacing = unit(0, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), axis.text.x=element_text(angle=90),plot.title = element_text(size=10, hjust = 0.5), panel.border= element_blank())
ggplot(LarvByJarVarVizDat, aes(y=LarvaePerimeterum ,x=MaleIDNumber, color=JarTrt))+
geom_boxplot(alpha=0.5, position="identity") +
facet_grid(~ParentTrt*FemaleIDNumber, scale="free_x")+
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_boxplot(alpha=0.5, position="identity") +
labs(x = "Male ID", y= expression(paste("Perimeter (", mu, "m)")), title = "Female ID") +
scale_color_manual(name = "Larval Treatment", labels = c("Control", "OA"), values = c("#004D4F", "#F7645A"))+
geom_hline(yintercept=ConConMeans$LarvaePerimeterum, color="midnightblue", lty=2)+
geom_hline(yintercept=ConExpMeans$LarvaePerimeterum, color="red", lty=2)+
theme_classic() +
theme(axis.title.y.right = element_blank(),                # hide right axis title
axis.text.y.right = element_blank(),                 # hide right axis labels
axis.ticks.y = element_blank(),                      # hide left/right axis ticks
axis.text.y = element_text(margin = margin(r = 0)),  # move left axis labels closer to axis
panel.spacing = unit(0, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), axis.text.x=element_text(angle=90),plot.title = element_text(size=10, hjust = 0.5), panel.border= element_blank())
ggplot(LarvByJarVarVizDat, aes(y=(LarvaePerimeterum/LarvaeDiamum),x=MaleIDNumber, color=JarTrt))+
geom_boxplot(alpha=0.5, position="identity") +
facet_grid(~ParentTrt*FemaleIDNumber, scale="free_x")+
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_boxplot(alpha=0.5, position="identity") +
labs(x = "Male ID", y= paste("Perimeter:Length"), title = "Female ID") +
scale_color_manual(name = "Larval Treatment", labels = c("Control", "OA"), values = c("#004D4F", "#F7645A"))+
theme_classic() +
theme(axis.title.y.right = element_blank(),                # hide right axis title
axis.text.y.right = element_blank(),                 # hide right axis labels
axis.ticks.y = element_blank(),                      # hide left/right axis ticks
axis.text.y = element_text(margin = margin(r = 0)),  # move left axis labels closer to axis
panel.spacing = unit(0, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), axis.text.x=element_text(angle=90),plot.title = element_text(size=10, hjust = 0.5), panel.border= element_blank())
#make bar graph of survival
ggplot(data = MeanSurvDat, aes(x = ParentTrt, y = RatSurv, fill="gray45")) +
geom_bar(stat="identity", position="dodge")+
ylim(c(0,1))+
geom_hline(yintercept=1)+
geom_errorbar(aes(ymin= RatSurv-SESurvDat$RatSurv, ymax=RatSurv+SESurvDat$RatSurv),width=0.2, position=position_dodge(.9))+
labs(x = "Parent Treatment", y = "Proportion of Surviving Larvae \n (OA:Control)") +
scale_x_discrete(breaks=c("400","2600"),
labels=c("Control", "OA"))+
scale_fill_manual(values = "gray45") +
geom_text(aes(label=c("a", "a"),
position = 3,
size=2), vjust = -1)+
theme_classic()
ggplot(SurvDat,aes(x=JarTrt, y=LarvaeSurvived, color = "black45", group= CrossID)) +
geom_rect(aes(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, fill = ParentTrt), colour=NA)+
scale_fill_manual(values =c("#B1FDFF", "#FCCECB"))+
geom_point(aes(color="black45"))+
geom_line(aes(color="black45", group=CrossID))+
scale_x_discrete(labels=LarvTreat)+
geom_errorbar(aes(ymin= LarvaeSurvived-SELarvaeSurvived, ymax=LarvaeSurvived+SELarvaeSurvived),width=0.05, position=position_dodge(0))+
labs(x = "Larvae Treatment", y = "Number of Larvae Survived") +
scale_color_manual(values="black")+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat))+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
table(LarvByJarDat$ProtocolVersion)
Prot1.5<- LarvByJarDat %>%
filter(ProtocolVersion== "1_5")
colnames(Prot1.5)
select=c("LarvaeSurvived", "v2SurvCount", "PropSurviving", "RatSurv", "TotalLarvae", "SWRCountTotal", "NumSWR", "F1LarvaeCount", "F2LarvaeCount", "F2PersonProcessed", "F1PersonProcessed")
Prot1.5<- LarvByJarDat %>%
filter(ProtocolVersion== "1_5") %>%
subset(select=c("LarvaeSurvived", "v2SurvCount", "PropSurviving", "RatSurv", "TotalLarvae", "SWRCountTotal", "NumSWR", "F1LarvaeCount", "F2LarvaeCount", "F2PersonProcessed", "F1PersonProcessed"))
View(Prot1.5)
Prot1.5<- LarvByJarDat %>%
filter(ProtocolVersion== "1_5") %>%
subset(select=c("LarvaeSurvived", "v2SurvCount", "PropSurviving", "RatSurv", "TotalLarvae", "SWRTotal", "NumSWR", "F1LarvaeCount", "F2LarvaeCount", "F2PersonProcessed", "F1PersonProcessed"))
plot(F1LarvaeCount~SWRTotal, data= Prot1.5)
abline(b=1)
abline(a=1)
abline(a=1, b=0)
par(xpr=FALSE)
par(xrd=FALSE)
par(xrp=FALSE)
par(xpr=FALSE)
par(xpd=FALSE)
plot(F1LarvaeCount~SWRTotal, data= Prot1.5)
abline(a=0, b=1)
Prot1.5$PercentDiff<- with(Prot1.5, (SWRTotal- F1LarvaeCount)/SWRTotal)
plot(PercentDiff~SWRTotal)
plot(PercentDiff~SWRTotal, data=Prot1.5)
mean(Prot1.5$PercentDiff)
plot(LarvaeSurvived~CrossID, data=LarvByJarDat)
ProtCheck<- LarvByJarDat
ProtCheck$ProtFixed<- ifelse(ProtCheck$ProtocolVersion=="1_5", paste("2"), paste(ProtCheck$ProtocolVersion))
ggplot(ProtCheck,aes(x=CrossID, y=LarvaeSurvived, color = ProtFixed)) +
geom_point(aes(color=ProtFixed))+
labs(x = "Family", y = "Number of Larvae Survived") +
scale_color_manual(values=c("black", "red"))+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat))+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
ggplot(ProtCheck,aes(x=CrossID, y=LarvaeSurvived, color = ProtFixed)) +
geom_point(aes(color=ProtFixed))+
labs(x = "Family", y = "Number of Larvae Survived") +
scale_color_manual(values=c("black", "red"))+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat), scale="free_x" )+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
ggplot(ProtCheck,aes(x=CrossID, y=LarvaeSurvived, color = ProtFixed, shape= JarTrt)) +
geom_point(aes(color=ProtFixed))+
labs(x = "Family", y = "Number of Larvae Survived") +
scale_color_manual(values=c("black", "red"))+
facet_grid(.~ParentTrt, labeller =labeller(ParentTrt = ParTreat), scale="free_x" )+
theme_classic() +
theme(panel.spacing = unit(0.2, "mm"),                    # remove spacing between facets
strip.background = element_rect(colour="white", fill="white"), panel.border= element_blank())
colnames(LarvByJarDat)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt*JarSatArg_SW + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID))
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt*JarSatArg_SW + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID), data=LarvByJarDat)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt*JarSatArg_SW + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID), data=ProtFixed)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt*JarSatArg_SW + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID), data=ProtCheck)
Protstep<- ste(ProtTestMod)
Protstep<- step(ProtTestMod)
summary(ProtTestMod)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID), data=ProtCheck)
Protstep<- step(ProtTestMod)
print(Protstep)
summary(ProtTestMod)
(versionvariance<-582.3/(77903.8+43090.1+582.3+14912.9)
(versionvariance<-582.3/(77903.8+43090.1+582.3+14912.9))
(versionvariance<-582.3/(77903.8+43090.1+582.3+14912.9))
(versionvariance<-(582.3/(77903.8+43090.1+582.3+14912.9)))*100
View(SurvDat)
View(SurvDatToWide)
LarvByJarDat
colnames(LarvByJarDat)
colnames(LarvByJarDatExpLarvae)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID)+(1|TrtTankID)+(1|MaleTrtTankID), data=ProtCheck)
Protstep<- step(ProtTestMod)
print(Protstep) #drops protocol version from model
summary(ProtTestMod)
ProtTestMod<- lmer(LarvaeSurvived~ParentTrt*JarTrt + (1|ProtFixed)+ (1|FemaleID)+ (1|MaleID)+ (1|CrossID)+(1|TrtTankID)+(1|MaleTrtTankID), data=ProtCheck)
Protstep<- step(ProtTestMod)
print(Protstep) #drops protocol version from model
summary(ProtTestMod)
(versionvariance<-(596.0   /(77747.3  +31078.3  +571.9   +18786.5  +596.0   +12817.6  )))*100
table(ProtCheck$ProtocolVersion)
table(ProtCheck$ProtFixed)
138/(138+131)
131/(138+131)
Prot1.5<- ProtCheck %>%
filter(ProtocolVersion=="1_5")
write.csv(Prot1.5, "~/R/GitHub/LarvaeTransGen2018/data/Prot1.5.csv")
