xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = ParentTrt, y = LarvaeDiamum, x = JarOmegaCalcite, group=interaction(FemaleID,MaleID))) +
geom_point(aes(shape= MaleID, colour=ParentID)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = ParentTrt, y = LarvaeDiamum, x = JarOmegaCalcite, group=interaction(FemaleID,MaleID))) +
geom_point(aes(shape= MaleID, colour=ParentTrt)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = ParentTrt, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= MaleID, colour=ParentTrt)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = ParentTrt, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=ParentTrt)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(data = meanlarv, aes(x = JarOmegaCalcite, y = LarvaeDiamum, group=ParentTrt, fill=ParentTrt)) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.05, position=position_dodge(0))+
geom_errorbarh(aes(xmin= meanlarv$JarOmegaCalcite-selarv$JarOmegaCalcite, xmax=meanlarv$JarOmegaCalcite+selarv$JarOmegaCalcite),width=0.05, position=position_dodge(0))+
geom_point(aes(colour=ParentTrt))+
labs(x = "Larvae Jar Saturation State (Calcite)", y = "Larvae Diameter (um)") +
abline(larvlenfin)+
scale_color_manual(values = c("skyblue2", "red2")) +
theme_classic()
ggplot(data = meanlarv, aes(x = JarOmegaCalcite, y = LarvaeDiamum, group=ParentTrt, fill=ParentTrt)) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.05, position=position_dodge(0))+
geom_errorbarh(aes(xmin= meanlarv$JarOmegaCalcite-selarv$JarOmegaCalcite, xmax=meanlarv$JarOmegaCalcite+selarv$JarOmegaCalcite),width=0.05, position=position_dodge(0))+
geom_point(aes(colour=ParentTrt))+
labs(x = "Larvae Jar Saturation State (Calcite)", y = "Larvae Diameter (um)") +
scale_color_manual(values = c("skyblue2", "red2")) +
theme_classic()
ggplot(LarvaeDat,
aes(fill = pHSwCorr, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=pHSwCorr)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = pHSWCorr, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=pHSwCorr)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(LarvaeDat,
aes(fill = pHSWCorr, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=pHSWCorr)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
ggplot(data = meanlarv, aes(x = JarOmegaCalcite, y = LarvaeDiamum, group=ParentTrt, fill=ParentTrt)) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.05, position=position_dodge(0))+
geom_errorbarh(aes(xmin= meanlarv$JarOmegaCalcite-selarv$JarOmegaCalcite, xmax=meanlarv$JarOmegaCalcite+selarv$JarOmegaCalcite),width=0.05, position=position_dodge(0))+
geom_point(aes(colour=ParentTrt))+
labs(x = "Larvae Jar Saturation State (Calcite)", y = "Larvae Diameter (um)") +
scale_color_manual(values = c("skyblue2", "red2")) +
theme_classic()
ggplot(data = meanlarv, aes(x = JarTrt, y = LarvaeDiamum, fill=ParentTrt)) +
geom_bar(stat="identity", aes(fill=ParentTrt), position="dodge")+
labs(x = "Larvae Treatment", y = "Larvae Diameter (um)") +
scale_fill_manual(name = "Parent Treatment", labels = c("Control", "OA"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.2, position=position_dodge(.9))+
theme_classic()
ggplot(data = meanlarv, aes(x = ParentTrt , y = LarvaeDiamum, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Diameter (um)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.2, position=position_dodge(.9))+
theme_classic()
ggplot(data = meanlarv, aes(x = JarTrt, y = LarvaeDiamum, fill=ParentTrt)) +
geom_bar(stat="identity", aes(fill=ParentTrt), position="dodge")+
labs(x = "Larvae Treatment", y = "Larvae Diameter (um)") +
scale_fill_manual(name = "Parent Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.2, position=position_dodge(.9))+
theme_classic()
ggplot(data = meanlarv, aes(x = ParentTrt , y = LarvaeDiamum, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Diameter (um)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanlarv$LarvaeDiamum-selarv$LarvaeDiamum, ymax=meanlarv$LarvaeDiamum+selarv$LarvaeDiamum),width=0.2, position=position_dodge(.9))+
theme_classic()
crossdiff <- data.frame(tapply(Larvae$LarvaeDiamum, list(Larvae$CrossID, Larvae$JarTrt), mean)) %>%
rownames_to_column("CrossID") %>%
mutate(CrossTemp = CrossID) %>%
mutate(ParentTrt = ifelse(startsWith(CrossID, "E"), "Exposed", "Control")) %>%
separate(CrossTemp, c("FemaleID", "MaleID", "BlockID", "Fourth"), sep="_") %>% select(-Fourth) %>%
mutate(Diff = Exposed - Control)
crossdiff$CrossID<- as.factor(crossdiff$CrossID)
crossdiff$FemaleID<-as.factor(crossdiff$FemaleID)
crossdiff$MaleID<-as.factor(crossdiff$MaleID)
ggplot(data = crossdiff, aes(x = MaleID, y = Diff)) +
geom_point(aes(colour=FemaleID)) +
labs(x = "Male ID", y = "Change in mean shell length (um) per family\nfrom control to OA conditions") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"), panel.border=element_rect(colour="black", fill=NA))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
meandiff<- aggregate(Diff~ParentTrt, data=crossdiff, FUN=mean)
sediff<-  aggregate(Diff~ParentTrt, data=crossdiff, FUN=se)
ggplot(data = meandiff, aes(x = ParentTrt, y = Diff)) +
geom_bar(stat="identity", aes(fill="gray45"), position="dodge") +
labs(x = "Parental Treatment", y = "Change in mean shell length (um) per family\nfrom control to OA conditions") +
scale_x_discrete(breaks = c("Control", "Exposed"), labels = c("Control", "OA Exposed")) +
scale_fill_manual(values = "gray45") +
geom_errorbar(aes(ymin= meandiff$Diff-sediff$Diff, ymax=meandiff$Diff+sediff$Diff),width=0.2, position=position_dodge(.9))+
theme(legend.position = "none", panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"))
diffttest<- t.test(Diff~ParentTrt, data=crossdiff, var.equal=T)
diffttest #mean shell length difference is significantly higher for OA parent treatment
summary(diffttest) #mean shell length difference is significantly higher for OA parent treatment
diffttest #mean shell length difference is significantly higher for OA parent treatment
Larvae$LarvaeAge<- Larvae$TimeFixed- Larvae$TimeCross
str(Larvae$TimeFixed)
str(Larvae$TimeCross)
Larvae$GrowthPerDay<- (Larvae$LarvaeDiamum-Larvae$EggDiamum)/3
View(Larvae)
Larvae$GrowthPerDay
larvgrow<-lmer(GrowthPerDay~pHSWCorr*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|TimeFilter)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvgrow<- step(larvgrow)
print(steppedlarvgrow)
larvgrowfin<- lmer(GrowthPerDay~pHSWCorr*JarOmegaCalcite+(1|FemaleID)+(1|MaleID)+(1|JarID), data=Larvae)
plot(larvgrowfin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvgrowfin))
qqline(resid(larvgrowfin)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvgrowfin)
acf(resid(larvgrowfin)) #this looks fine to me.
larvgrowfin<- lmer(GrowthPerDay~WCa_pHDIC*JarOmegaCalcite+(1|FemaleID)+(1|MaleID)+(1|JarID), data=Larvae)
larvgrow<-lmer(GrowthPerDay~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|TimeFilter)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvgrow<- step(larvgrow)
ggplot(LarvaeDat,
aes(fill = WCa_pHDIC, y = LarvaeDiamum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae diameter by larvae jar saturation state")+
ylab("Larvae Diameter (um)")+
xlab("Larvae Jar Calcite Saturation State")+
theme_classic()
print(steppedlarvgrow)
larvgrowfin<- lmer(GrowthPerDay~WCa_pHDIC*JarOmegaCalcite+(1|FemaleID)+(1|MaleID)+(1|JarID), data=Larvae)
plot(larvgrowfin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvgrowfin))
qqline(resid(larvgrowfin)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvgrowfin)
acf(resid(larvgrowfin)) #this looks fine to me.
ggplot(Larvae,
aes(fill = JarTrt, y = GrowthPerDay, x = ParentTrt)) +
geom_point(aes(shape= Block, colour=JarTrt)) +
ggtitle("Larvae growth by parent treatment")+
ylab("Growth (um/day)")+
theme_classic()
ggplot(Larvae,
aes(fill = WCa_pHDIC, y = GrowthPerDay, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae growth by parent treatment")+
ylab("Growth (um/day)")+
theme_classic()
meangrowth<- aggregate(GrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=mean)
segrowth<- aggregate(GrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meangrowth, aes(x = ParentTrt, y = GrowthPerDay, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Growth (um/day)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meangrowth$GrowthPerDay-segrowth$GrowthPerDay, ymax=meangrowth$GrowthPerDay+segrowth$GrowthPerDay),width=0.2, position=position_dodge(.9))+
theme_classic()
summary(larvgrowfin)
larvgrow<-lmer(GrowthPerDay~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvgrow<- step(larvgrow)
print(steppedlarvgrow)
larvgrowfin<- lmer(GrowthPerDay~WCa_pHDIC*JarOmegaCalcite+(1|FemaleID)+(1|MaleID)+(1|JarID)+ (1|JarSeatable), data=Larvae)
plot(larvgrowfin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvgrowfin))
qqline(resid(larvgrowfin)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvgrowfin)
acf(resid(larvgrowfin)) #this looks fine to me.
ggplot(Larvae,
aes(fill = WCa_pHDIC, y = GrowthPerDay, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae growth by parent treatment")+
ylab("Growth (um/day)")+
theme_classic()
meangrowth<- aggregate(GrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=mean)
segrowth<- aggregate(GrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meangrowth, aes(x = ParentTrt, y = GrowthPerDay, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Growth (um/day)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meangrowth$GrowthPerDay-segrowth$GrowthPerDay, ymax=meangrowth$GrowthPerDay+segrowth$GrowthPerDay),width=0.2, position=position_dodge(.9))+
theme_classic()
growthdiff <- data.frame(tapply(Larvae$GrowthPerDay, list(Larvae$CrossID, Larvae$JarTrt), mean)) %>%
rownames_to_column("CrossID") %>%
mutate(CrossTemp = CrossID) %>%
mutate(ParentTrt = ifelse(startsWith(CrossID, "E"), "Exposed", "Control")) %>%
separate(CrossTemp, c("FemaleID", "MaleID", "BlockID", "Fourth"), sep="_") %>% select(-Fourth) %>%
mutate(Diff = Exposed - Control)
growthdiff$CrossID<- as.factor(growthdiff$CrossID)
growthdiff$FemaleID<-as.factor(growthdiff$FemaleID)
growthdiff$MaleID<-as.factor(growthdiff$MaleID)
ggplot(data = growthdiff, aes(x = MaleID, y = Diff)) +
geom_point(aes(colour=FemaleID)) +
labs(x = "Male ID", y = "Change in larvae growth (um/day) per family\nfrom control to OA conditions") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"), panel.border=element_rect(colour="black", fill=NA))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
meangrdiff<- aggregate(Diff~ParentTrt, data=growthdiff, FUN=mean)
segrdiff<-  aggregate(Diff~ParentTrt, data=growthdiff, FUN=se)
ggplot(data = meangrdiff, aes(x = ParentTrt, y = Diff)) +
geom_bar(stat="identity", aes(fill="gray45"), position="dodge") +
labs(x = "Parental Treatment", y = "Change in larvae growth (um) per family\nfrom control to OA conditions") +
scale_x_discrete(breaks = c("Control", "Exposed"), labels = c("Control", "OA")) +
scale_fill_manual(values = "gray45") +
geom_errorbar(aes(ymin= meangrdiff$Diff-segrdiff$Diff, ymax=meangrdiff$Diff+segrdiff$Diff),width=0.2, position=position_dodge(.9))+
theme(legend.position = "none", panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"))
diffgrttest<- t.test(Diff~ParentTrt, data=growthdiff, var.equal=T)
diffgrttest #significant effect of parent treatment on growth.
boxplot(LarvaeAreaum2~Block*ParentTrt, data=Larvae)
anovarea<- aov(LarvaeAreaum2~ParentTrt*JarTrt, data=Larvae)
anova(anovarea)
shapiro.test(anovarea$residuals) #doesn't meet assumption of normality
par(mfcol=c(2,2))
plot(anovarea)
par(mfcol=c(1,1))
larvarea<-lmer(LarvaeAreaum2~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvarea<-step(larvarea)
print(steppedlarvarea)
larvareafin<- lmer(LarvaeAreaum2~JarOmegaCalcite+(1|FemaleID)+(1|MaleID)+ (1|JarSeatable)+(1|JarID), data=Larvae)
plot(larvareafin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvareafin))
qqline(resid(larvareafin)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvareafin)
acf(resid(larvareafin)) #this looks fine to me.
ggplot(Larvae,
aes(fill = WCa_pHDIC, y = LarvaeAreaum2, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae area by larvae treatment")+
ylab("Larvae Area (um2)")+
theme_classic()
meanarea<- aggregate(LarvaeAreaum2~ParentTrt*JarTrt, data=Larvae, FUN=mean)
searea<- aggregate(LarvaeAreaum2~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meanarea, aes(x = ParentTrt, y = LarvaeAreaum2, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Area (um2)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanarea$LarvaeAreaum2-searea$LarvaeAreaum2, ymax=meanarea$LarvaeAreaum2+searea$LarvaeAreaum2),width=0.2, position=position_dodge(.9))+
theme_classic()
areadiff <- data.frame(tapply(Larvae$LarvaeAreaum2, list(Larvae$CrossID, Larvae$JarTrt), mean)) %>%
rownames_to_column("CrossID") %>%
mutate(CrossTemp = CrossID) %>%
mutate(ParentTrt = ifelse(startsWith(CrossID, "E"), "Exposed", "Control")) %>%
separate(CrossTemp, c("FemaleID", "MaleID", "BlockID", "Fourth"), sep="_") %>% select(-Fourth) %>%
mutate(Diff = Exposed - Control)
areadiff$CrossID<- as.factor(crossdiff$CrossID)
areadiff$FemaleID<-as.factor(crossdiff$FemaleID)
areadiff$MaleID<-as.factor(crossdiff$MaleID)
ggplot(data = areadiff, aes(x = MaleID, y = Diff)) +
geom_point(aes(colour=FemaleID)) +
labs(x = "Male ID", y = "Change in mean shell area (um2) per family\nfrom control to OA conditions") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"), panel.border=element_rect(colour="black", fill=NA))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
meanareadiff<- aggregate(Diff~ParentTrt, data=areadiff, FUN=mean)
seareadiff<-  aggregate(Diff~ParentTrt, data=areadiff, FUN=se)
ggplot(data = meanareadiff, aes(x = ParentTrt, y = Diff)) +
geom_bar(stat="identity", aes(fill="gray45"), position="dodge") +
labs(x = "Parental Treatment", y = "Change in mean shell area (um2) per family\nfrom control to OA conditions") +
scale_x_discrete(breaks = c("Control", "Exposed"), labels = c("Control", "OA")) +
scale_fill_manual(values = "gray45") +
geom_errorbar(aes(ymin= meanareadiff$Diff-seareadiff$Diff, ymax=meanareadiff$Diff+seareadiff$Diff),width=0.2, position=position_dodge(.9))+
theme(legend.position = "none", panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"))
diffareattest<- aov(Diff~ParentTrt, data=areadiff)
diffareattest<- t.test(Diff~ParentTrt, data=areadiff)
diffareattest #mean shell area difference is significantly higher for OA parent treatment
shapiro.test(diffareattest$residuals)
shapiro.test(diffareattest$residuals)
str(diffareattest$residuals)
Larvae$AreaGrowthPerDay<- (Larvae$LarvaeAreaum2-Larvae$EggAreaum2)/3
larvgrowarea<-lmer(AreaGrowthPerDay~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvgrowarea<- step(larvgrowarea)
print(steppedlarvgrowarea)
larvgrowareafin<- lmer(AreaGrowthPerDay~JarTrt+(1|FemaleID)+(1|MaleID)+ (1|TimeFilter)+(1|JarID), data=Larvae)
larvgrowareafin<- lmer(AreaGrowthPerDay~JarTrt+(1|FemaleID)+(1|MaleID)+ (1|CrossID)+ (1|JarSeatable)+(1|JarID), data=Larvae)
plot(larvgrowareafin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvgrowareafin))
qqline(resid(larvgrowareafin)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvgrowareafin)
acf(resid(larvgrowareafin)) #this looks fine to me.
ggplot(Larvae,
aes(fill = WCa_pHDIC, y = AreaGrowthPerDay, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae growth by larvae treatment")+
ylab("Area Growth (um/day)")+
theme_classic()
meanareagrowth<- aggregate(AreaGrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=mean)
seareagrowth<- aggregate(AreaGrowthPerDay~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meanareagrowth, aes(x = ParentTrt, y = AreaGrowthPerDay, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Growth (um/day)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanareagrowth$AreaGrowthPerDay-seareagrowth$AreaGrowthPerDay, ymax=meanareagrowth$AreaGrowthPerDay+seareagrowth$AreaGrowthPerDay),width=0.2, position=position_dodge(.9))+
theme_classic()
areagrowthdiff <- data.frame(tapply(Larvae$AreaGrowthPerDay, list(Larvae$CrossID, Larvae$JarTrt), mean)) %>%
rownames_to_column("CrossID") %>%
mutate(CrossTemp = CrossID) %>%
mutate(ParentTrt = ifelse(startsWith(CrossID, "E"), "Exposed", "Control")) %>%
separate(CrossTemp, c("FemaleID", "MaleID", "BlockID", "Fourth"), sep="_") %>% select(-Fourth) %>%
mutate(Diff = Exposed - Control)
areagrowthdiff$CrossID<- as.factor(areagrowthdiff$CrossID)
areagrowthdiff$FemaleID<-as.factor(areagrowthdiff$FemaleID)
areagrowthdiff$MaleID<-as.factor(areagrowthdiff$MaleID)
ggplot(data = areagrowthdiff, aes(x = MaleID, y = Diff)) +
geom_point(aes(colour=FemaleID)) +
labs(x = "Male ID", y = "Change in larvae growth area (um2/day) per family\nfrom control to OA conditions") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"), panel.border=element_rect(colour="black", fill=NA))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
meanardiff<- aggregate(Diff~ParentTrt, data=areagrowthdiff, FUN=mean)
seardiff<-  aggregate(Diff~ParentTrt, data=areagrowthdiff, FUN=se)
ggplot(data = meanardiff, aes(x = ParentTrt, y = Diff)) +
geom_bar(stat="identity", aes(fill="gray45"), position="dodge") +
labs(x = "Parental Treatment", y = "Change in larvae growth area (um2) per family\nfrom control to OA conditions") +
scale_x_discrete(breaks = c("Control", "Exposed"), labels = c("Control", "OA")) +
scale_fill_manual(values = "gray45") +
geom_errorbar(aes(ymin= meanardiff$Diff-seardiff$Diff, ymax=meanardiff$Diff+seardiff$Diff),width=0.2, position=position_dodge(.9))+
theme(legend.position = "none", panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), panel.background = element_blank(),
axis.line = element_line(colour = "black"))
diffarttest<- t.test(Diff~ParentTrt, data=areagrowthdiff)
diffarttest #significant effect of parent treatment on growth.
Larvae$MajMinRat<- Larvae$LarvaeMajorAxisLengthPix/Larvae$LarvaeMinorAxisLengthPix
meanrat<- aggregate(MajMinRat~ParentTrt*JarTrt, data=Larvae, FUN=mean)
serat<- aggregate(MajMinRat~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meanrat, aes(x = JarOmegaCalcite, y = MajMinRat, fill=WCa_pHDIC)) +
geom_bar(stat="identity", aes(fill=WCa_pHDIC), position="dodge")+
labs(x = "Larvae Treatment", y = "Ratio of Major to Minor Axis") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanrat$MajMinRat-serat$MajMinRat, ymax=meanrat$MajMinRat+serat$MajMinRat),width=0.2, position=position_dodge(.9))+
geom_errorbarh(aes(xmin= meanrat$JarOmegaCalcite-serat$JarOmegaCalcite, xmax=meanrat$JarOmegaCalcite+serat$JarOmegaCalcite),width=0.2, position=position_dodge(.9))+
theme_classic()
View(meanrat)
meanrat<- ddply(Larvae, .(JarTrt, ParentTrt), numcolwise(mean, na.rm=T))
serat<- ddply(Larvae, .(JarTrt, ParentTrt), numcolwise(se, na.rm=T))
ggplot(data = meanrat, aes(x = JarOmegaCalcite, y = MajMinRat, fill=WCa_pHDIC)) +
geom_bar(stat="identity", aes(fill=WCa_pHDIC), position="dodge")+
labs(x = "Larvae Treatment", y = "Ratio of Major to Minor Axis") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanrat$MajMinRat-serat$MajMinRat, ymax=meanrat$MajMinRat+serat$MajMinRat),width=0.2, position=position_dodge(.9))+
geom_errorbarh(aes(xmin= meanrat$JarOmegaCalcite-serat$JarOmegaCalcite, xmax=meanrat$JarOmegaCalcite+serat$JarOmegaCalcite),width=0.2, position=position_dodge(.9))+
theme_classic()
ggplot(data = meanrat, aes(x = ParentTrt, y = MajMinRat, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Ratio of Major to Minor Axis") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanrat$MajMinRat-serat$MajMinRat, ymax=meanrat$MajMinRat+serat$MajMinRat),width=0.2, position=position_dodge(.9))+
theme_classic()
larvrat<-lmer(MajMinRat~ParentTrt*JarTrt+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
plot(larvrat) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvrat))
qqline(resid(larvrat)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvrat) #no significant differences
larvrat<-lmer(MajMinRat~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
plot(larvrat) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvrat))
qqline(resid(larvrat)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvrat) #no significant differences
acf(resid(larvrat)) #this looks fine to me.
steplarvrat<- step(larvrat)
larvrat<-lmer(MajMinRat~WCa_pHDIC+JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
larvrat<-lmer(MajMinRat~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
larvrat1<-lmer(MajMinRat~WCa_pHDIC+JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
anova(larvrat, larvrat1)
AIC(larvrat)
AIC(larvrat1)
summary(larvrat1)
larvrat2<-lmer(MajMinRat~JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
anova(larvrat1, larvrat2)
larvrat3<-lmer(MajMinRat~WCa_pHDIC+ (1|FemaleID)+(1|MaleID)+(1|JarSeatable)+(1|JarID) , data=Larvae)
anova(larvrat2, larvrat3)
lmrat1<- lm(MajMinRat~WCa_pHDIC*JarOmegaCalcite, data=Larvae)
plot(resid(lmrat1)~Larvae$FemaleID)
plot(larvrat) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvrat))
qqline(resid(larvrat)) #has relatively long tails, doesn't seem to meet assumption of normality.
summary(larvrat) #no significant differences, but interaction between parent treatment and larval treatment are both nearly significant
acf(resid(larvrat)) #this looks fine to me.
hist(Larvae$LarvaeEccentricity)#data are left skewed.
meaneccen<- aggregate(LarvaeEccentricity~ParentTrt*JarTrt, data=Larvae, FUN=mean)
seeccen<- aggregate(LarvaeEccentricity~ParentTrt*JarTrt, data=Larvae, FUN=se)
ggplot(data = meaneccen, aes(x = ParentTrt, y = LarvaeEccentricity, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Eccentricity") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meaneccen$LarvaeEccentricity-seeccen$LarvaeEccentricity, ymax=meaneccen$LarvaeEccentricity+seeccen$LarvaeEccentricity),width=0.2, position=position_dodge(.9))+
theme_classic()
larveccen<-lmer(LarvaeEccentricity~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarveccen<- step(larveccen)
print(steppedlarveccen)
larveccenfin<- lmer(LarvaeEccentricity~JarOmegaCalcite+ (1|FemaleID)+(1|JarID), data=Larvae)
plot(larveccenfin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larveccenfin))
qqline(resid(larveccenfin)) #has relatively long tails, doesn't meet assumption of normality.
summary(larveccenfin)
acf(resid(larveccenfin)) #this looks fine to me.
larveccent<-lmer((LarvaeEccentricity^2)~JarOmegaCalcite+ (1|FemaleID)+(1|JarID) , data=Larvae)
plot(larveccent) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larveccent))
qqline(resid(larveccent)) #has relatively long tails, doesn't meet assumption of normality.
summary(larveccent) #no significant differences
ggplot(data = meaneccen, aes(x = ParentTrt, y = LarvaeEccentricity, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Eccentricity") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meaneccen$LarvaeEccentricity-seeccen$LarvaeEccentricity, ymax=meaneccen$LarvaeEccentricity+seeccen$LarvaeEccentricity),width=0.2, position=position_dodge(.9))+
theme_classic()
hist(Larvae$LarvaePerimeterum)
larvperim<-lmer(LarvaePerimeterum~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID)+(1|TrtTankID)+(1|AccTankID)+(1|Block) , data=Larvae)
steppedlarvperim<- step(larvperim)
print(steppedlarvperim)
larvperimfin<- lmer(LarvaePerimeterum~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID), data=Larvae)
plot(larvperimfin) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvperimfin))
qqline(resid(larvperimfin)) #has relatively long tails, doesn't meet assumption of normality.
summary(larvperimfin)
acf(resid(larvperimfin)) #this looks fine to me.
larvperimfint<- lmer(sqrt(LarvaePerimeterum)~WCa_pHDIC*JarOmegaCalcite+ (1|FemaleID)+(1|MaleID)+(1|CrossID)+(1|JarSeatable)+(1|JarID), data=Larvae)
plot(larvperimt) #seems to meet assumption of linearity and homoscedasticity
plot(larvperimfint) #seems to meet assumption of linearity and homoscedasticity
qqnorm(resid(larvperimfint))
qqline(resid(larvperimfint)) #has relatively long tails, doesn't meet assumption of normality.
ggplot(Larvae,
aes(fill = WCa_pHDIC, y = LarvaePerimeterum, x = JarOmegaCalcite)) +
geom_point(aes(shape= Block, colour=WCa_pHDIC)) +
ggtitle("Larvae area by larvae treatment")+
ylab("Larvae Perimeter (um)")+
theme_classic()
meanperim<- ddply(Larvae, .(JarTrt, ParentTrt), numcolwise(mean, na.rm=T))
seperim<- ddply(Larvae, .(JarTrt, ParentTrt), numcolwise(se, na.rm=T))
ggplot(data = meanperim, aes(x = ParentTrt, y = LarvaePerimeterum, fill=JarTrt)) +
geom_bar(stat="identity", aes(fill=JarTrt), position="dodge")+
labs(x = "Parent Treatment", y = "Larvae Perimeter (um)") +
scale_fill_manual(name = "Larvae Treatment", labels = c("Control", "OA Exposed"), values = c("skyblue2", "red2")) +
geom_errorbar(aes(ymin= meanperim$LarvaePerimeterum-seperim$LarvaePerimeterum, ymax=meanperim$LarvaePerimeterum+seperim$LarvaePerimeterum),width=0.2, position=position_dodge(.9))+
theme_classic()
summary(larvperimfin)
Tank_WCB1B2<- subset(Tank_WC, Block != "B3")
library(tidyverse)
library(plyr)
library(sciplot)
library(reshape2)
library(lme4)
library(lmerTest)
library(blme)
library(grid)
library(data.table)
library(gridExtra)
library(lattice)
#library(optimx)
library(car)
library(Hmisc)
library(corrplot)
library(emmeans)
library(chron)
#setwd("~/Repos/LarvaeTransGen2018")
setwd("~/R/GitHub/LarvaeTransGen2018/data") #Elise's working directory
#upload all of the data tables for the larvae experiment
Larvae_Morphology <- read.csv("../data/Larvae_Morphology.csv") #contains data from CellProfiler from the larvae outlines
Barcode_Jar <- read.csv("../data/Barcode_Jar.csv") #contains data on CrossID, seatable, and whether or not larvae were present
Block_ID <- read.csv("../data/Block_ID.csv") #contains data on the block
Cross<- read.csv("../data/Cross.csv") #contains data on the female and male IDs for the cross and whether the cross was for QG or Meth
Fert_QG<- read.csv("../data/Fert_QG.csv") #contains data on fertilization counts, the JarIDs for the crosses
Header_WC<- read.csv("../data/Header_WC.csv") #contains data on the header tanks used to fill the jars
Larvae_Calcification <- read.csv("../data/Larvae_Calcification.csv") #contains data on filter weights and counts
Larvae_Counts <- read.csv("../data/Larvae_Counts.csv") #contains data on sedgewick rafter larvae counts
Larvae_WC <- read.csv("../data/Larvae_WC.csv") #contains data on larvae jar water chemistry
Parent_ID <- read.csv("../data/Parent_ID.csv") #contains data on the adults at the time of shucking. Includes Parent ID assignments
Larvae_Cilia<- read.csv("../data/Larvae_Cilia.csv") #contains data on cilia extrusion of the larvae photographed for morphology
Egg_Morphology<- read.csv("../data/Egg_Morphology.csv") #contains data on egg sizes from CellProfiler
Adult_Sample<- read.csv("../data/Adult_Sample.csv") #contains data on adult oysters at the time of collection
WC_Standard<- read.csv("../data/WC_Standard.csv") #contains data on the standards used for water chemistry
Tank_WC<- read.csv("../data/Tank_WC.csv") #contains data on the adult tank water chemistry
Adult_Sample$AccTankID<- as.factor(Adult_Sample$AccTankID)
Adult_Sample$TrtTankID<- as.factor(Adult_Sample$TrtTankID)
Barcode_Jar$JarSeatable<- as.factor(Barcode_Jar$JarSeatable)
Tank_WC$ParentTrt<- as.factor(Tank_WC$ParentTrt)
Tank_WC$Tank<- as.factor(Tank_WC$Tank)
Tank_WC$Folder<- as.factor(Tank_WC$Folder)
WC_Standard$CRM<- as.factor(WC_Standard$CRM)
Larvae_WC$DateFilter<- as.factor(Larvae_WC$DateFilter)
Tank_WCB1B2<- subset(Tank_WC, Block != "B3")
boxplot(WCa_pHDIC~Tank, data=Tank_WCB1B2)
Tank_WCB1B2<- subset(Tank_WC, Block != "B3", na.omit=TRUE)
